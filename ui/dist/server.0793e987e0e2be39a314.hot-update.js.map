{"version":3,"sources":["webpack:///./src/SignInNavItem.jsx"],"names":["SignInNavItem","React","Component","constructor","props","state","showing","disabled","user","signedIn","givenName","signIn","bind","signOut","showModal","hideModal","setState","componentDidMount","clientId","window","ENV","GOOGLE_CLIENT_ID","gapi","load","auth2","getAuthInstance","init","client_id","then","showError","googleUser","getBasicProfile","getImageUrl","console","log","error","render","withToast"],"mappings":"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","file":"server.0793e987e0e2be39a314.hot-update.js","sourcesContent":["import React from \"react\";\r\nimport { NavItem, Modal, Button, NavDropdown, MenuItem } from \"react-bootstrap\";\r\nimport withToast from \"./withToast.jsx\";\r\n\r\nclass SignInNavItem extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      showing: false,\r\n      disabled: true,\r\n      user: { signedIn: false, givenName: \"\" },\r\n    };\r\n    this.signIn = this.signIn.bind(this);\r\n    this.signOut = this.signOut.bind(this);\r\n    this.showModal = this.showModal.bind(this);\r\n    this.hideModal = this.hideModal.bind(this);\r\n  }\r\n  signIn() {\r\n    this.hideModal();\r\n    this.setState({ user: { signedIn: true, givenName: \"User1\" } });\r\n  }\r\n\r\n  signOut() {\r\n    this.setState({ user: { signedIn: false, givenName: \"\" } });\r\n  }\r\n\r\n  showModal() {\r\n    this.setState({ showing: true });\r\n  }\r\n  hideModal() {\r\n    this.setState({ showing: false });\r\n  }\r\n\r\n  componentDidMount() {\r\n    const clientId = window.ENV.GOOGLE_CLIENT_ID;\r\n    if (!clientId) return;\r\n    window.gapi.load(\"auth2\", () => {\r\n      if (!window.gapi.auth2.getAuthInstance()) {\r\n        window.gapi.auth2.init({ client_id: clientId }).then(() => {\r\n          this.setState({ disabled: false });\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  async signIn() {\r\n    this.hideModal();\r\n    const { showError } = this.props;\r\n    try {\r\n      const auth2 = window.gapi.auth2.getAuthInstance();\r\n      const googleUser = await auth2.signIn();\r\n      //      const givenName = googleUser.getBasicProfile().getGivenName();\r\n      const givenName = googleUser.getBasicProfile().getImageUrl();\r\n      this.setState({ user: { signedIn: true, givenName } });\r\n      console.log(givenName);\r\n    } catch (error) {\r\n      showError(`Error authenticating with Google:${error.error}`);\r\n    }\r\n  }\r\n\r\n  showModal() {\r\n    const clientId = window.ENV.GOOGLE_CLIENT_ID;\r\n    const { showError } = this.props;\r\n    if (!clientId) {\r\n      showError(\"Missing environment variable GOOGLE_CLIENT_ID\");\r\n      return;\r\n    }\r\n    this.setState({ showing: true });\r\n  }\r\n\r\n  render() {\r\n    const { user } = this.state;\r\n    const { showing, disabled } = this.state;\r\n    if (user.signedIn) {\r\n      return (\r\n        <NavDropdown\r\n          title={\r\n            <img\r\n              className=\"thumbnail-image\"\r\n              src={user.givenName}\r\n              alt=\"Sign In\"\r\n            />\r\n          }\r\n          id=\"user\"\r\n        >\r\n          <MenuItem onClick={this.signOut}>Sign out</MenuItem>\r\n        </NavDropdown>\r\n      );\r\n    } else {\r\n      return (\r\n        <>\r\n          <NavItem onClick={this.showModal}>Sign in</NavItem>\r\n          <Modal show={showing} onHide={this.hideModal} bsSize=\"sm\">\r\n            <Modal.Header closeButton>\r\n              <Modal.Title>Sign</Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n              <Button\r\n                block\r\n                bsStyle=\"primary\"\r\n                onClick={this.signIn}\r\n                disabled={disabled}\r\n              >\r\n                <img\r\n                  src=\"https://developers.google.com/identity/images/btn_google_signin_light_normal_web.png\"\r\n                  alt=\"Sign In\"\r\n                />\r\n              </Button>\r\n            </Modal.Body>\r\n            <Modal.Footer>\r\n              <Button bsStyle=\"link\" onClick={this.hideModal}>\r\n                Cancel\r\n              </Button>\r\n            </Modal.Footer>\r\n          </Modal>\r\n        </>\r\n      );\r\n    }\r\n  }\r\n}\r\nexport default withToast(SignInNavItem);\r\n"],"sourceRoot":""}