{"version":3,"sources":["webpack:///./src/IssueList.jsx"],"names":["IssueList","React","Component","fetchData","match","search","showError","params","URLSearchParams","vars","hasSelection","selectedId","get","status","effortMin","parseInt","Number","isNaN","effortMax","id","idInt","query","data","graphQLFetch","constructor","issues","store","initialData","List","selectedIssue","state","loading","closeIssue","bind","deleteIssue","componentDidMount","loadData","console","log","componentDidUpdate","prevProps","location","prevSearch","prevId","props","err","setState","issue","error","index","showSuccess","prevState","newList","issueUpdate","pathname","history","issueDelete","push","splice","render","style","margin","hasFilter","Status","IssueListWithToast","withToast"],"mappings":"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","file":"server.a9ec26910a077851cf0a.hot-update.js","sourcesContent":["import React from \"react\";\r\nimport IssueFilter from \"./IssueFilter.jsx\";\r\nimport store from \"./Store.js\";\r\nimport IssueTable from \"./IssueTable.jsx\";\r\nimport IssueReport from \"./IssueReport.jsx\";\r\nimport graphQLFetch from \"./graphQLFetch.js\";\r\nimport IssueDetail from \"./IssueDetail.jsx\";\r\nimport URLSearchParams from \"url-search-params\"; //the url search parameter are installed in here and are passed to other components\r\nimport { Panel } from \"react-bootstrap\";\r\nimport withToast from \"./withToast.jsx\";\r\n\r\nclass IssueList extends React.Component {\r\n  static async fetchData(match, search, showError) {\r\n    const params = new URLSearchParams(search);\r\n    const vars = { hasSelection: false, selectedId: 0 };\r\n    if (params.get(\"status\")) vars.status = params.get(\"status\");\r\n    const effortMin = parseInt(params.get(\"effortMin\"), 10);\r\n    if (!Number.isNaN(effortMin)) vars.effortMin = effortMin;\r\n    const effortMax = parseInt(params.get(\"effortMax\"), 10);\r\n    if (!Number.isNaN(effortMax)) vars.effortMax = effortMax;\r\n\r\n    const {\r\n      params: { id },\r\n    } = match;\r\n    const idInt = parseInt(id, 10);\r\n    if (!Number.isNaN(idInt)) {\r\n      vars.hasSelection = true;\r\n      vars.selectedId = idInt;\r\n    }\r\n    const query = `query List(\r\n      $status : StatusType\r\n      $effortMin: Int\r\n      $effortMax : Int\r\n      $hasSelection : Boolean!\r\n      $selectedId : Int!\r\n    ){\r\n      List(\r\n        status : $status\r\n        effortMin : $effortMin\r\n        effortMax : $effortMax\r\n      )\r\n      {id title status owner created effort due}                                                                                                 \r\n      issue(id : $selectedId) @include (if : $hasSelection){\r\n        id description\r\n      }\r\n    }`;\r\n    const data = await graphQLFetch(query, vars, showError);\r\n    return data;\r\n  }\r\n  constructor() {\r\n    super();\r\n    const issues = store.initialData ? store.initialData.List : null;\r\n    const selectedIssue = store.initialData ? store.initialData.issues : null;\r\n    delete store.initialData;\r\n    this.state = {\r\n      issues,\r\n      selectedIssue,\r\n      loading: true,\r\n    };\r\n\r\n    this.closeIssue = this.closeIssue.bind(this);\r\n    this.deleteIssue = this.deleteIssue.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { issues } = this.state;\r\n    if (issues == null) {\r\n      this.loadData();\r\n      console.log(\"the componenet is loaded\");\r\n    } else {\r\n      console.log(\"no issues\");\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    try {\r\n      const {\r\n        location: { search: prevSearch },\r\n        match: {\r\n          params: { id: prevId },\r\n        },\r\n      } = prevProps;\r\n      const {\r\n        location: { search },\r\n        match: {\r\n          params: { id },\r\n        },\r\n      } = this.props;\r\n      if (prevSearch !== search || prevId !== id) {\r\n        this.loadData();\r\n        console.log(`component did update is working fine `);\r\n      }\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  }\r\n\r\n  async loadData() {\r\n    try {\r\n      const {\r\n        location: { search },\r\n        match,\r\n        showError,\r\n      } = this.props;\r\n      const data = await IssueList.fetchData(match, search, showError);\r\n\r\n      if (data) {\r\n        this.setState({\r\n          issues: data.List,\r\n          selectedIssue: data.issue,\r\n        });\r\n      }\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  }\r\n\r\n  async closeIssue(index) {\r\n    const { showSuccess, showError } = this.props;\r\n    const query = `mutation issueClose($id:Int!){\r\n    issueUpdate(id:$id,changes:{status:Closed}){\r\n      id title status owner effort created due description\r\n    }\r\n  }`;\r\n    const { issues } = this.state;\r\n    const data = await graphQLFetch(query, { id: issues[index].id }, showError);\r\n    if (data) {\r\n      this.setState((prevState) => {\r\n        const newList = [...prevState.issues];\r\n        newList[index] = data.issueUpdate;\r\n        return { issues: newList };\r\n      });\r\n    } else {\r\n      this.loadData();\r\n    }\r\n  }\r\n\r\n  async deleteIssue(index) {\r\n    const { showSuccess, showError } = this.props;\r\n    const query = `mutation issueDelete($id:Int!){\r\n    issueDelete(id:$id)\r\n  }`;\r\n    const { issues } = this.state;\r\n    const {\r\n      location: { pathname, search },\r\n      history,\r\n    } = this.props;\r\n    const { id } = issues[index];\r\n    const data = await graphQLFetch(query, { id }, showError);\r\n    if (data && data.issueDelete) {\r\n      this.setState((prevState) => {\r\n        const newList = [...prevState.issues];\r\n        if (pathname === `/issues/${id}`) {\r\n          history.push({ pathname: \"/issues\", search });\r\n        }\r\n        newList.splice(index, 1);\r\n        return { issues: newList };\r\n      });\r\n      showSuccess(`Deleted issue ${id} successfully`);\r\n    } else {\r\n      this.loadData();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { issues } = this.state;\r\n    if (issues == null) return null;\r\n    const { selectedIssue } = this.state;\r\n    const style = {\r\n      margin: 30,\r\n    };\r\n\r\n    const hasFilter = location.search !== \"\";\r\n    return (\r\n      <div id=\"all\">\r\n        <Panel defaultExpanded={hasFilter}>\r\n          <Panel.Heading>\r\n            <Panel.Title toggle>Filter</Panel.Title>\r\n          </Panel.Heading>\r\n          <Panel.Body collapsible>\r\n            <IssueFilter urlBase=\"/issues\" />\r\n          </Panel.Body>\r\n        </Panel>\r\n\r\n        <hr />\r\n        <IssueTable\r\n          issues={this.state.issues}\r\n          closeIssue={this.closeIssue}\r\n          stat={this.state.Status}\r\n          deleteIssue={this.deleteIssue}\r\n        />\r\n        <hr />\r\n        <IssueDetail issue={selectedIssue} />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst IssueListWithToast = withToast(IssueList);\r\nIssueListWithToast.fetchData = IssueList.fetchData;\r\nexport default IssueListWithToast;\r\n"],"sourceRoot":""}