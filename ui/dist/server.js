!function(e){var t={};function n(a){if(t[a])return t[a].exports;var s=t[a]={i:a,l:!1,exports:{}};return e[a].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(a,s,function(t){return e[t]}.bind(null,s));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=14)}([function(e,t){e.exports=require("react")},function(e,t){e.exports=require("react-bootstrap")},function(e,t){e.exports=require("react-router-dom")},function(e,t){e.exports=require("react-router-bootstrap")},function(e,t){e.exports=require("url-search-params")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("http-proxy-middleware")},function(e,t){e.exports=require("serialize-javascript")},function(e,t){e.exports=require("webpack")},function(e,t){e.exports=require("dotenv")},function(e,t){e.exports=require("source-map-support")},function(e,t){e.exports=require("react-dom/server")},function(e,t){e.exports=require("isomorphic-fetch")},function(e,t){e.exports=require("react-select/lib/Async.js")},function(e,t,n){e.exports=n(20)},function(e,t,n){(function(t){const a=n(8),s=n(16),o=n(17),i={mode:"development",entry:{app:["./browser/App.jsx"]},output:{filename:"[name].bundle.js",path:s.resolve(t,"public"),publicPath:"/"},module:{rules:[{test:/\.jsx?$/,exclude:/node_modules/,use:{loader:"babel-loader",options:{presets:[["@babel/preset-env",{targets:{ie:"11",edge:"15",safari:"10",firefox:"50",chrome:"49"}}],"@babel/preset-react"]}}}]},optimization:{splitChunks:{name:"vendor",chunks:"all"}},plugins:[new a.DefinePlugin({_isBrowser_:"true"})],devtool:"source-map"},r={mode:"development",entry:{server:["./server/uiserver.js"]},target:"node",externals:[o()],output:{filename:"server.js",path:s.resolve(t,"dist"),publicPath:"/"},module:{rules:[{test:/\.jsx?$/,use:{loader:"babel-loader",options:{presets:[["@babel/preset-env",{targets:{node:"10"}}],"@babel/preset-react"]}}}]},plugins:[new a.DefinePlugin({_isBrowser_:"false"})],devtool:"source-map"};e.exports=[i,r]}).call(this,"/")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("webpack-node-externals")},function(e,t){e.exports=require("webpack-dev-middleware")},function(e,t){e.exports=require("webpack-hot-middleware")},function(e,t,n){"use strict";n.r(t);var a=n(9),s=n.n(a),o=n(5),i=n.n(o),r=n(6),l=n.n(r),c=n(10),u=n.n(c),h=n(0),d=n.n(h),m=n(2),p=n(11),g=n.n(p),E=n(4),f=n.n(E),b=n(1);class v extends d.a.Component{constructor({location:{search:e}}){super();const t=new f.a(e);this.state={status:t.get("status")||"",effortMin:t.get("effortMin")||"",effortMax:t.get("effortMax")||"",changed:!1},this.onChangeStatus=this.onChangeStatus.bind(this),this.onChangeEffortMin=this.onChangeEffortMin.bind(this),this.onChangeEffortMax=this.onChangeEffortMax.bind(this),this.applyFilter=this.applyFilter.bind(this),this.showOtiginalFilter=this.showOriginalFilter.bind(this)}componentDidUpdate(e){const{location:{search:t}}=e,{location:{search:n}}=this.props;t!==n&&this.showOtiginalFilter()}onChangeStatus(e){this.setState({status:e.target.value,changed:!0})}onChangeEffortMin(e){e.target.value.match(/^\d*$/)&&this.setState({effortMin:e.trget.value,changed:!0})}onChangeEffortMax(e){e.target.value.match(/^\d*$/)&&this.setState({effortMax:e.target.value,changed:!0})}showOriginalFilter(){const{location:{search:e}}=this.props,t=new f.a(e);this.setState({status:t.get("status")||"",effortMin:t.get("effortMin")||"",effortMax:t.get("effrotMax")||"",changed:!1})}applyFilter(){const{status:e,effortMax:t,effortMin:n}=this.state,{history:a,urlBase:s}=this.props,o=new f.a;e&&o.set("status",e),n&&o.set("effortMin",n),t&&o.set("effortMax",t);const i=o.toString()?`?${o.toString()}`:"";a.push({pathname:s,search:i})}render(){const{location:{search:e}}=this.props,{status:t,changed:n}=(new f.a(e),this.state),{effortMin:a,effortMax:s}=this.state;return d.a.createElement(b.Row,{className:"selection"},d.a.createElement(b.Col,{xs:6,sm:4,md:3,lg:2},d.a.createElement(b.FormGroup,null,d.a.createElement(b.ControlLabel,null,"Status:"),d.a.createElement(b.FormControl,{componentClass:"select",value:t,onChange:this.onChangeStatus},d.a.createElement("option",{value:""},"All"),d.a.createElement("option",{value:"New"},"New"),d.a.createElement("option",{value:"Fixed"},"Fixed"),d.a.createElement("option",{value:"Closed"},"Closed"),d.a.createElement("option",{value:"Assigned"},"Assigned")))),d.a.createElement(b.Col,{xs:6,sm:4,md:3,lg:2},d.a.createElement(b.FormGroup,null,d.a.createElement(b.ControlLabel,null,"Effort Between"),d.a.createElement(b.InputGroup,null,d.a.createElement(b.FormControl,{value:a,onChange:this.onChangeEffortMin}),d.a.createElement(b.InputGroup.Addon,null,"-"),d.a.createElement(b.FormControl,{value:s,onChange:this.onChangeEffortMax})))),d.a.createElement(b.Col,{xs:6,sm:4,md:3,lg:2},d.a.createElement(b.FormGroup,null,d.a.createElement(b.ControlLabel,null,"Â "),d.a.createElement(b.ButtonToolbar,null,d.a.createElement(b.Button,{bsStyle:"primary",type:"button",onClick:this.applyFilter},"Apply"),"    ",d.a.createElement(b.Button,{bsStyle:"primary",type:"button",onClick:this.showOtiginalFilter,disabled:!n},"Reset")))))}}var C=Object(m.withRouter)(v),w=n(3);var y={};var I=d.a.createContext({signedIn:!1});function S(e){const t=e.issues.map((t,n)=>d.a.createElement(N,{key:t.id,issue:t,closeIssue:e.closeIssue,deleteIssue:e.deleteIssue,index:n}));return d.a.createElement(d.a.Fragment,null,d.a.createElement(b.Table,{responsive:!0,striped:!0,bordered:!0,condensed:!0,hover:!0,style:{textAlign:"center"}},d.a.createElement("thead",null,d.a.createElement("tr",null,d.a.createElement("th",null," ID"),d.a.createElement("th",null,"Status"),d.a.createElement("th",null," Owner"),d.a.createElement("th",null,"Created"),d.a.createElement("th",null," Effort"),d.a.createElement("th",null,"Due Date"),d.a.createElement("th",null," Title"),d.a.createElement("th",null,"Action"))),d.a.createElement("tbody",null,t)))}class D extends d.a.Component{render(){const{issue:e,location:{search:t},closeIssue:n,deleteIssue:a,index:s}=this.props,o=!this.context.signedIn,i={pathname:`/issues/${e.id}`,search:t},r=d.a.createElement(b.Tooltip,{id:"close-tooltip",placement:"top"},"Edit"),l=d.a.createElement(b.Tooltip,{id:"close-tooltip",placement:"top"},"Close Issue"),c=d.a.createElement(b.Tooltip,{id:"delete-tooltip",placement:"top"},"Delete Issue");const u=d.a.createElement("tr",null,d.a.createElement("td",null,e.id),d.a.createElement("td",null,e.status),d.a.createElement("td",null,e.owner),d.a.createElement("td",null,e.created.toDateString()),d.a.createElement("td",null,e.effort),d.a.createElement("td",null,e.due?e.due.toDateString():""),d.a.createElement("td",null,e.title),d.a.createElement("td",null,d.a.createElement(w.LinkContainer,{to:`/edit/${e.id}`},d.a.createElement(b.OverlayTrigger,{delayShow:1e3,overlay:r},d.a.createElement(b.Button,{bsSize:"xsmall"},d.a.createElement(b.Glyphicon,{glyph:"edit"})))),"  |  ",d.a.createElement(b.OverlayTrigger,{delayShow:200,overlay:l},d.a.createElement(b.Button,{disabled:o,bsSize:"xsmall",type:"button",onClick:function(e){e.preventDefault(),n(s)}},d.a.createElement(b.Glyphicon,{glyph:"remove"}))),"  |  ",d.a.createElement(b.OverlayTrigger,{delayShow:200,overlay:c},d.a.createElement(b.Button,{disabled:o,bsSize:"xsmall",type:"button",onClick:function(e){e.preventDefault(),a(s)}},d.a.createElement(b.Glyphicon,{glyph:"trash"})))));return d.a.createElement(w.LinkContainer,{to:i},u)}}D.contextType=I;const N=Object(m.withRouter)(D);delete N.contextType;var x=n(12),M=n.n(x);const T=new RegExp("^\\d\\d\\d\\d-\\d\\d-\\d\\d");function O(e,t){return T.test(t)?new Date(t):t}var _=async function(e,t={},n=null,a=null){const s=process.env.UI_SERVER_API_ENDPOINT;try{const o={"Content-Type":"application/json"};a&&(o.Cookie=a);const i=await M()(s,{method:"POST",credentials:"include",headers:o,body:JSON.stringify({query:e,variables:t})}),r=await i.text(),l=JSON.parse(r,O);if(l.errors){const e=l.errors[0];if("BAD_USER_INPUT"===e.extensions.code){const t=e.extensions.exception.errors.join("\n");n&&n(`${e.message}:\n${t}`)}else n&&n(`${e.extensions.code}:${e.message}`)}return l.data}catch(e){n&&n(`Error in sending data to server:${e.message}`)}};function F({issue:e}){return e?d.a.createElement("div",null,d.a.createElement("h3",null,"Descripton"),d.a.createElement("pre",null,e.description)):null}class P extends d.a.Component{componentDidUpdate(){const{showing:e,onDismiss:t}=this.props;e&&(clearTimeout(this.dismissTimer),this.dismissTimer=setTimeout(t,5e3))}componentWillUnmount(){clearTimeout(this.dismissTimer)}render(){const{showing:e,bsStyle:t,onDismiss:n,children:a}=this.props;return d.a.createElement(b.Collapse,{in:e},d.a.createElement("div",{style:{position:"fixed",bottom:20,left:20,zIndex:10}},d.a.createElement(b.Alert,{bsStyle:t,onDismiss:n},a)))}}function $(){return($=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function k(e){return class extends d.a.Component{constructor(e){super(e),this.state={toastVisible:!1,toastMessage:"",toastType:"success"},this.showSuccess=this.showSuccess.bind(this),this.showError=this.showError.bind(this),this.dismissToast=this.dismissToast.bind(this)}showSuccess(e){this.setState({toastVisible:!0,toastMessage:e,toastType:"success"})}showError(e){this.setState({toastVisible:!0,toastMessage:e,toastType:"danger"})}dismissToast(e){this.setState({toastVisible:!1})}render(){const{toastType:t,toastVisible:n,toastMessage:a}=this.state;return d.a.createElement(d.a.Fragment,null,d.a.createElement(e,$({showError:this.showError,showSuccess:this.showSuccess,dismissToast:this.dismissToast},this.props)),d.a.createElement(P,{bsStyle:t,showing:n,onDismiss:this.dismissToast},a))}}}function A({params:e,page:t,activePage:n,children:a}){return e.set("page",t),0===t?d.a.cloneElement(a,{disabled:!0}):d.a.createElement(w.LinkContainer,{isActive:()=>t===n,to:{search:`?${e.toString()}`}},a)}class U extends d.a.Component{static async fetchData(e,t,n){const a=new f.a(t),s={hasSelection:!1,selectedId:0};a.get("status")&&(s.status=a.get("status"));const o=parseInt(a.get("effortMin"),10);Number.isNaN(o)||(s.effortMin=o);const i=parseInt(a.get("effortMax"),10);Number.isNaN(i)||(s.effortMax=i);let r=parseInt(a.get("page"),10);Number.isNaN(r)&&(r=1),s.page=r;const{params:{id:l}}=e,c=parseInt(l,10);Number.isNaN(c)||(s.hasSelection=!0,s.selectedId=c);return await _("query List(\n      $status : StatusType\n      $effortMin: Int\n      $effortMax : Int\n      $hasSelection : Boolean!\n      $selectedId : Int!\n      $page : Int!\n    ){\n      List(\n        status : $status\n        effortMin : $effortMin\n        effortMax : $effortMax\n        page: $page\n      )\n      { \n        issues\n        {id title status owner created effort due}\n        pages\n      }    \n         \n            issue(id : $selectedId) @include (if : $hasSelection){id description }\n    }",s,n,null)}constructor(){super();const e=y.initialData||{List:{}},{List:{issues:t,pages:n},issue:a}=e;delete y.initialData,this.state={issues:t,selectedIssue:a,loading:!0,pages:n},this.closeIssue=this.closeIssue.bind(this),this.deleteIssue=this.deleteIssue.bind(this)}componentDidMount(){const{issues:e}=this.state;null==e?(this.loadData(),console.log("the componenet is loaded")):console.log("no issues")}componentDidUpdate(e){try{const{location:{search:t},match:{params:{id:n}}}=e,{location:{search:a},match:{params:{id:s}}}=this.props;t===a&&n===s||(this.loadData(),console.log("component did update is working fine "))}catch(e){console.log(e)}}async loadData(){try{const{location:{search:e},match:t,showError:n}=this.props,a=await U.fetchData(t,e,n);a&&this.setState({issues:a.List.issues,selectedIssue:a.issue,pages:a.List.pages})}catch(e){console.error(e)}}async closeIssue(e){const{showSuccess:t,showError:n}=this.props,{issues:a}=this.state,s=await _("mutation issueClose($id:Int!){\n    issueUpdate(id:$id,changes:{status:Closed}){\n      id title status owner effort created due description\n    }\n  }",{id:a[e].id},n);s?this.setState(t=>{const n=[...t.issues];return n[e]=s.issueUpdate,{issues:n}}):this.loadData()}async deleteIssue(e){const{showSuccess:t,showError:n}=this.props,{issues:a}=this.state,{location:{pathname:s,search:o},history:i}=this.props,{id:r}=a[e],l=await _("mutation issueDelete($id:Int!){\n    issueDelete(id:$id)\n  }",{id:r},n);if(l&&l.issueDelete){this.setState(t=>{const n=[...t.issues];return s===`/issues/${r}`&&i.push({pathname:"/issues",search:o}),n.splice(e,1),{issues:n}}),t(d.a.createElement("span",null,`Deleted issue${r} successfully.`,d.a.createElement(b.Button,{bsStyle:"link",onClick:()=>this.restoreIssue(r)},"UNDO")))}else this.loadData()}async restoreIssue(e){const{showSuccess:t,showError:n}=this.props;await _("mutation issueRestore($id:Int!){\n      issueRestore(id:$id)\n    }",{id:e},n)&&(t(`issue${e} restored  successfully`),this.loadData())}render(){const{issues:e,pages:t,selectedIssue:n}=this.state,{location:{search:a}}=this.props;if(null==e)return null;const s=""!==location.search,o=new f.a(a);let i=parseInt(o.get("page"),10);Number.isNaN(i)&&(i=1);const r=5*Math.floor((i-1)/5)+1,l=r+5-1,c=1===r?0:r-5,u=l>=t?0:r+5,h=[];for(let e=r;e<=Math.min(l,t);e++)o.set("page",e),h.push(d.a.createElement(A,{key:e,params:o,activePage:i,page:e},d.a.createElement(b.Pagination.Item,null,e)));return d.a.createElement("div",{id:"all"},d.a.createElement(b.Panel,{defaultExpanded:s},d.a.createElement(b.Panel.Heading,null,d.a.createElement(b.Panel.Title,{toggle:!0},"Filter")),d.a.createElement(b.Panel.Body,{collapsible:!0},d.a.createElement(C,{urlBase:"/issues"}))),d.a.createElement("hr",null),d.a.createElement(S,{issues:this.state.issues,closeIssue:this.closeIssue,stat:this.state.Status,deleteIssue:this.deleteIssue}),d.a.createElement("hr",null),d.a.createElement(F,{issue:n}),d.a.createElement(b.Pagination,null,d.a.createElement(A,{params:o,page:c},d.a.createElement(b.Pagination.Item,null,"<")),h,d.a.createElement(A,{params:o,page:u},d.a.createElement(b.Pagination.Item,null,">"))))}}const B=k(U);B.fetchData=U.fetchData;var L=B;const j=["New","Assigned","Fixed","Closed"];class G extends d.a.Component{static async fetchData(e,t,n){const a=new URLSearchParams(t),s={};a.get("status")&&(s.status=a.get("status"));const o=parseInt(a.get("effortMin"),10);Number.isNaN(o)||(s.effortMin=o);const i=parseInt(a.get("effortMax"),10);Number.isNaN(i)||(s.effortMax=i);return await _("query List(\n      $status: StatusType\n      $effortMin: Int\n      $effortMax: Int\n    ) {\n      issueCounts(\n        status: $status\n        effortMin: $effortMin\n        effortMax: $effortMax\n      ) {\n        owner New Assigned Fixed Closed\n      }\n    }",s,n)}constructor(e){super(e);const t=y.initialData?y.initialData.issueCounts:null;delete y.initialData,this.state={stats:t}}componentDidMount(){const{stats:e}=this.state;null==e&&this.loadData()}componentDidUpdate(e){const{location:{search:t}}=e,{location:{search:n}}=this.props;t!==n&&this.loadData()}async loadData(){console.log(this.props);const{location:{search:e},match:t,showError:n}=this.props,a=await G.fetchData(t,e,n);a&&this.setState({stats:a.issueCounts})}render(){const{stats:e}=this.state;if(null==e)return null;const t=j.map(e=>d.a.createElement("th",{key:e},e)),n=e.map(e=>d.a.createElement("tr",{key:e.owner},d.a.createElement("td",null,e.owner),j.map(t=>d.a.createElement("td",{key:t},e[t]))));return d.a.createElement(d.a.Fragment,null,d.a.createElement(b.Panel,null,d.a.createElement(b.Panel.Heading,null,d.a.createElement(b.Panel.Title,{toggle:!0},"Filter")),d.a.createElement(b.Panel.Body,{collapsible:!0},d.a.createElement(C,{urlBase:"/report"}))),d.a.createElement(b.Table,{bordered:!0,condensed:!0,hover:!0,responsive:!0},d.a.createElement("thead",null,d.a.createElement("tr",null,d.a.createElement("th",null),t)),d.a.createElement("tbody",null,n)))}}const V=k(G);V.fetchData=G.fetchData;var R=V;function q(){return(q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}class H extends d.a.Component{constructor(e){var t;super(e),this.state={value:(t=e.value,null!=t?t.toString():"")},this.onBlur=this.onBlur.bind(this),this.onChange=this.onChange.bind(this)}onChange(e){e.target.value.match(/^\d*$/)&&this.setState({value:e.target.value})}onBlur(e){const{onChange:t}=this.props,{value:n}=this.state;t(e,function(e){const t=parseInt(e,10);return Number.isNaN(t)?null:t}(n))}render(){const{value:e}=this.state;return d.a.createElement("input",q({type:"text"},this.props,{value:e,onBlur:this.onBlur,onChange:this.onChange}))}}function z(){return(z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}class J extends d.a.Component{constructor(e){var t;super(e),this.state={value:(t=e.value,null!=t?t.toISOString().substr(0,10):""),focused:!1,valid:!0},this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),this.onChange=this.onChange.bind(this)}onFocus(){this.setState({focused:!0})}onBlur(e){const{value:t,valid:n}=this.state,{onValidityChange:a,onChange:s}=this.props,o=function(e){const t=new Date(e);return Number.isNaN(t.getTime())?null:t}(t),i=""===t||null!=o;i!==n&&a&&a(e,i),this.setState({focused:!1,valid:i}),i&&s(e,o)}onChange(e){e.target.value.match(/^[\d-]*$/)&&this.setState({value:e.target.value})}render(){const{valid:e,focused:t,value:n}=this.state,{value:a,onValidityChange:s,...o}=this.props,i=t||!e?n:null!=(r=a)?r.toDateString():"";var r;return d.a.createElement("input",z({},o,{value:i,placeholder:t?"yyyy-mm-dd":null,onFocus:this.onFocus,onBlur:this.onBlur,onChange:this.onChange}))}}class W extends d.a.Component{constructor(e){var t;super(e),this.state={value:(t=e.value,null!=t?t:"")},this.onBlur=this.onBlur.bind(this),this.onChange=this.onChange.bind(this)}onChange(e){this.setState({value:e.target.value})}onBlur(e){const{onChange:t}=this.props,{value:n}=this.state;var a;t(e,0===(a=n).trim().length?null:a)}render(){const{value:e}=this.state,{tag:t="input",...n}=this.props;return d.a.createElement(t,{...n,value:e,onBlur:this.onBlur,onChange:this.onChange})}}class X extends d.a.Component{static async fetchData(e,t,n){const{params:{id:a}}=e,s=Number(a);return await _("query issue($id:Int!){\n      issue(id:$id){\n        id title status owner\n        effort created due description\n      }\n    }",{id:s},n)}constructor(){super();const e=y.initialData?y.initialData.issue:null;delete y.initialData,this.state={issue:e,invalidFields:{},showingValidation:!1},this.onChange=this.onChange.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.onValidityChange=this.onValidityChange.bind(this),this.showValidation=this.showValidation.bind(this),this.dismissValidation=this.dismissValidation.bind(this)}componentDidMount(){const{issue:e}=this.state;null==e&&this.loadData()}componentDidUpdate(e){const{match:{params:{id:t}}}=e,{match:{params:{id:n}}}=this.props;n!==t&&this.loadData()}onChange(e,t){const{name:n,value:a}=e.target,s=void 0===t?a:t;this.setState(e=>({issue:{...e.issue,[n]:s}}))}onValidityChange(e,t){const{name:n}=e.target;this.setState(e=>{const a={...e.invalidFields,[n]:!t};return t&&delete a[n],{invalidFields:a}})}async handleSubmit(e){e.preventDefault(),this.showValidation();const{issue:t,invalidFields:n}=this.state,{showSuccess:a,showError:s}=this.props;if(0!==Object.keys(n).length)return;const{id:o,created:i,...r}=t,l=await _("mutation issueUpdate(\n   $id:Int!\n   $changes:IssueUpdateInputs!\n    )\n    {\n      issueUpdate(\n        id:$id\n        changes:$changes\n      ){\n        id title status owner effort\n        created due description\n      }\n    }",{changes:r,id:o},s);l&&(this.setState({issue:l.issueUpdate}),a("Issue updated successfully"))}async loadData(){const{match:e,showError:t}=this.props,n=await X.fetchData(e,null,t);this.setState({issue:n?n.issue:{},invalidFields:{}})}showValidation(){this.setState({showingValidation:!0})}dismissValidation(){this.setState({showingValidation:!1})}render(){const{issue:e}=this.state;if(null==e)return null;const{issue:{id:t}}=this.state,{match:{params:{id:n}}}=this.props;if(null==t)return null!==n?d.a.createElement("div",null,d.a.createElement("h3",null,`Issue with ID ${n} not found.`)):null;const{invalidFields:a,showingValidation:s}=this.state;let o;console.log(a),0!==Object.keys(a).length&&s&&(o=d.a.createElement(b.Alert,{bsStyle:"danger",onDismiss:this.dismissValidation},"Please correct invalid fiels before submitting."));const{issue:{title:i,status:r}}=this.state,{issue:{owner:l,effort:c,description:u}}=this.state,{issue:{created:h,due:p}}=this.state,g=this.context;return d.a.createElement(b.Panel,null,d.a.createElement(b.Panel.Heading,null,d.a.createElement(b.Panel.Title,null,`Editing issue: ${t}`)),d.a.createElement(b.Panel.Body,null,d.a.createElement(b.Form,{horizontal:!0,onSubmit:this.handleSubmit},d.a.createElement(b.FormGroup,null,d.a.createElement(b.Col,{sm:3,lg:2,componentClass:b.ControlLabel},"Created"),d.a.createElement(b.Col,{sm:9},d.a.createElement(b.FormControl.Static,null,h.toDateString()))),d.a.createElement(b.FormGroup,null,d.a.createElement(b.Col,{sm:3,lg:2,componentClass:b.ControlLabel},"Status"),d.a.createElement(b.Col,{sm:9},d.a.createElement(b.FormControl,{componentClass:"select",name:"status",value:r,onChange:this.onChange},d.a.createElement("option",{value:"New"},"New"),d.a.createElement("option",{value:"Assigned"},"Assigned"),d.a.createElement("option",{value:"Fixed"},"Fixed"),d.a.createElement("option",{value:"Closed"},"Closed")))),d.a.createElement(b.FormGroup,null,d.a.createElement(b.Col,{sm:3,lg:2,componentClass:b.ControlLabel},"Owner"),d.a.createElement(b.Col,{sm:9},d.a.createElement(b.FormControl,{componentClass:W,name:"owner",value:l,onChange:this.onChange,key:t}))),d.a.createElement(b.FormGroup,null,d.a.createElement(b.Col,{sm:3,lg:2,componentClass:b.ControlLabel},"Effort"),d.a.createElement(b.Col,{sm:9},d.a.createElement(b.FormControl,{componentClass:H,name:"effort",value:c,onChange:this.onChange,key:t}))),d.a.createElement(b.FormGroup,{validationState:a.due?"error":null},d.a.createElement(b.Col,{sm:3,lg:2,componentClass:b.ControlLabel},"Due"),d.a.createElement(b.Col,{sm:9},d.a.createElement(b.FormControl,{componentClass:J,onValidityChange:this.onValidityChange,name:"due",value:p,onChange:this.onChange,key:t}),d.a.createElement(b.FormControl.Feedback,null))),d.a.createElement(b.FormGroup,null,d.a.createElement(b.Col,{sm:3,lg:2,componentClass:b.ControlLabel},"Title"),d.a.createElement(b.Col,{sm:9},d.a.createElement(b.FormControl,{componentClass:W,name:"title",value:i,onChange:this.onChange,key:t}))),d.a.createElement(b.FormGroup,null,d.a.createElement(b.Col,{sm:3,lg:2,componentClass:b.ControlLabel},"Description"),d.a.createElement(b.Col,{sm:9},d.a.createElement(b.FormControl,{componentClass:W,tag:"textarea",name:"description",rows:8,cols:50,value:u,onChange:this.onChange,key:t}))),d.a.createElement(b.FormGroup,null,d.a.createElement(b.Col,{smOffset:2,sm:6,componentClass:b.ControlLabel},d.a.createElement(b.ButtonToolbar,null,d.a.createElement(b.ButtonGroup,null,d.a.createElement(b.Button,{bsStyle:"primary",type:"submit",disabled:!g.signedIn},"Submit"),d.a.createElement(w.LinkContainer,{to:"/issues"},d.a.createElement(b.Button,{bsStyle:"link"},"Back")))))),d.a.createElement(b.FormGroup,null,d.a.createElement(b.Col,{smOffset:2,sm:9},o)))),d.a.createElement(b.Panel.Footer,null,d.a.createElement(m.Link,{to:`/edit/${t-1}`},d.a.createElement(b.Badge,null," Previous ")),"  | ",d.a.createElement(m.Link,{to:`/edit/${t+1}`},d.a.createElement(b.Badge,null," Next "))))}}X.contextType=I;const Y=k(X);Y.fetchData=X.fetchData;class K extends d.a.Component{static async fetchData(){return await _("query{about}")}constructor(e){super(e);const t=y.initialData?y.initialData.about:null;delete y.initialData,this.state={apiAbout:t}}async componentDidMount(){const{apiAbout:e}=this.state;if(null==e){const e=await K.fetchData();this.setState({apiAbout:e.about})}}render(){const{apiAbout:e}=this.state;return d.a.createElement("div",{className:"text-center"},d.a.createElement("h3",null,"Issue Tracker Version 0.9"),d.a.createElement("h4",null,e))}}var Q=[{path:"/issues/:id?",component:L},{path:"/edit/:id",component:Y},{path:"/report",component:R},{path:"/about",component:K},{path:"*",component:L}];function Z(){return(Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ee(){return d.a.createElement(m.Switch,null,Q.map(e=>d.a.createElement(m.Route,Z({},e,{key:e.path}))))}class te extends d.a.Component{constructor(e){super(e),this.state={showing:!1,disabled:!0,user:{signedIn:!1,givenName:""}},this.signIn=this.signIn.bind(this),this.signOut=this.signOut.bind(this),this.showModal=this.showModal.bind(this),this.hideModal=this.hideModal.bind(this)}showModal(){this.setState({showing:!0})}hideModal(){this.setState({showing:!1})}async componentDidMount(){const e=window.ENV.GOOGLE_CLIENT_ID;e&&(window.gapi.load("auth2",()=>{window.gapi.auth2.getAuthInstance()||window.gapi.auth2.init({client_id:e}).then(()=>{this.setState({disabled:!1})})}),await this.loadData())}async loadData(){const e=window.ENV.UI_AUTH_ENDPOINT,t=await fetch(`${e}/user`,{method:"POST",headers:{"Content-Type":"application/json","Same-Site":"None"}}),n=await t.text(),a=JSON.parse(n),{signedIn:s,givenName:o}=a;this.setState({user:{signedIn:s,givenName:o}})}async signIn(){this.hideModal();const{showError:e}=this.props;let t;try{const e=window.gapi.auth2.getAuthInstance();t=(await e.signIn()).getAuthResponse().id_token}catch(t){e(`Error authenticating with Google:${t.error}`)}try{const e=window.ENV.UI_AUTH_ENDPOINT,n=await fetch(`${e}/signin`,{method:"POST",headers:{"Content-Type":"application/json","Same-Site":"None"},credentials:"include",body:JSON.stringify({google_token:t})}),a=await n.text(),s=JSON.parse(a);console.log({result:s});const{signedIn:o,givenName:i}=s,{onUserChange:r}=this.props;r({signedIn:o,givenName:i})}catch(t){e(`Error signing into the app: ${t}`)}}async signOut(){this.hideModal();const e=window.ENV.UI_AUTH_ENDPOINT,{showError:t}=this.props;try{await fetch(`${e}/signout`,{method:"POST",headers:{"Content-Type":"application/json","Same-Site":"None"},credentials:"include"});const t=window.gapi.auth2.getAuthInstance();await t.signOut();const{onUserChange:n}=this.props;n({signedIn:!1,givenName:""})}catch(e){t(`error signing out ${e}`)}}showModal(){const e=window.ENV.GOOGLE_CLIENT_ID,{showError:t}=this.props;e?this.setState({showing:!0}):t("Missing environment variable GOOGLE_CLIENT_ID")}render(){const{user:e}=this.props,{showing:t,disabled:n}=this.state;return e.signedIn?d.a.createElement(b.NavDropdown,{title:e.givenName,id:"user"},d.a.createElement(b.MenuItem,{onClick:this.signOut},"Sign out")):d.a.createElement(d.a.Fragment,null,d.a.createElement(b.NavItem,{onClick:this.showModal},"Sign in"),d.a.createElement(b.Modal,{show:t,onHide:this.hideModal,bsSize:"sm"},d.a.createElement(b.Modal.Header,{closeButton:!0},d.a.createElement(b.Modal.Title,null,"Sign")),d.a.createElement(b.Modal.Body,null,d.a.createElement(b.Button,{block:!0,bsStyle:"primary",onClick:this.signIn,disabled:n},d.a.createElement("img",{src:"https://developers.google.com/identity/images/btn_google_signin_light_normal_web.png",alt:"Sign In"}))),d.a.createElement(b.Modal.Footer,null,d.a.createElement(b.Button,{bsStyle:"link",onClick:this.hideModal},"Cancel"))))}}var ne=k(te);class ae extends d.a.Component{constructor(){super(),this.state={showing:!1},this.showModal=this.showModal.bind(this),this.hideModal=this.hideModal.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}showModal(){this.setState({showing:!0})}hideModal(){this.setState({showing:!1})}async handleSubmit(e){e.preventDefault(),this.hideModal();const{showError:t}=this.props,n=document.forms.issueAdd,a={owner:n.owner.value,title:n.title.value,due:new Date((new Date).getTime()+864e6)},s=await _("mutation issueAdd($issue:IssueInputs!){\n                  issueAdd(issue:$issue){\n                     id\n                   }\n                    }",{issue:a},t);if(s){const{history:e}=this.props;e.push(`/edit/${s.issueAdd.id}`)}}render(){const{showing:e}=this.state,{user:{signedIn:t}}=this.props;return d.a.createElement(d.a.Fragment,null,d.a.createElement(b.NavItem,{onClick:this.showModal,disabled:!t},d.a.createElement(b.OverlayTrigger,{placement:"left",delayShow:1e3,overlay:d.a.createElement(b.Tooltip,{id:"create-issue"},"Create Issue")},d.a.createElement(b.Glyphicon,{glyph:"plus"}))),d.a.createElement(b.Modal,{keyboard:!0,show:e,onHide:this.hideModal},d.a.createElement(b.Modal.Header,{closeButton:!0},d.a.createElement(b.Modal.Title,null,"Create Issue")),d.a.createElement(b.Modal.Body,null,d.a.createElement(b.Form,{name:"issueAdd"},d.a.createElement(b.FormGroup,null,d.a.createElement(b.ControlLabel,null,"Title"),d.a.createElement(b.FormControl,{name:"title",autoFocus:!0})),d.a.createElement(b.FormGroup,null,d.a.createElement(b.ControlLabel,null,"Owner"),d.a.createElement(b.FormControl,{name:"owner",autoFocus:!0})))),d.a.createElement(b.Modal.Footer,null,d.a.createElement(b.ButtonToolbar,null,d.a.createElement(b.Button,{type:"button",bsStyle:"primary",onClick:this.handleSubmit},"Submit"),d.a.createElement(b.Button,{bsStyle:"link",onClick:this.hideModal},"Cancel")))))}}var se=k(Object(m.withRouter)(ae)),oe=n(13),ie=n.n(oe);class re extends d.a.Component{constructor(e){super(e),this.onChangeSelection=this.onChangeSelection.bind(this),this.loadOptions=this.loadOptions.bind(this)}onChangeSelection({value:e}){const{history:t}=this.props;t.push(`/edit/${e}`)}async loadOptions(e){if(e.length<3)return[];const{showError:t}=this.props;return(await _("query List($search: String) {\n      List(search: $search) {\n        issues {id title}\n      }\n    }",{search:e},t)).List.issues.map(e=>({label:`#${e.id}: ${e.title}`,value:e.id}))}render(){return d.a.createElement(ie.a,{instanceId:"search-select",value:"",loadOptions:this.loadOptions,filterOption:()=>!0,onChange:this.onChangeSelection,components:{DropdownIndicator:null}})}}var le=Object(m.withRouter)(k(re));function ce({user:e,onUserChange:t}){return d.a.createElement(b.Navbar,{inverse:!0,collapseOnSelect:!0},d.a.createElement(b.Navbar.Header,null,d.a.createElement(b.Navbar.Brand,null,"Issue Tracker"),d.a.createElement(b.Navbar.Toggle,null)),d.a.createElement(b.Navbar.Collapse,null,d.a.createElement(b.Nav,null,d.a.createElement(w.LinkContainer,{exact:!0,to:"/"},d.a.createElement(b.NavItem,null,"Home")),d.a.createElement(w.LinkContainer,{to:"/issues"},d.a.createElement(b.NavItem,null,"Issue List")),d.a.createElement(w.LinkContainer,{to:"/report"},d.a.createElement(b.NavItem,null,"Report"))),d.a.createElement(b.Col,{sm:5},d.a.createElement(b.Navbar.Form,null,d.a.createElement(le,null))),d.a.createElement(b.Nav,{pullRight:!0},d.a.createElement(se,{user:e,onUserChange:t}),d.a.createElement(ne,{user:e,onUserChange:t}),d.a.createElement(b.NavDropdown,{id:"user-dropdown",title:d.a.createElement(b.Glyphicon,{glyph:"option-vertical"}),noCaret:!0},d.a.createElement(w.LinkContainer,{to:"/about"},d.a.createElement(b.MenuItem,null,"About"))))))}function ue(){return d.a.createElement("small",null,d.a.createElement("hr",null),d.a.createElement("p",{className:"text-center"},"Full source code availabe at","   ",d.a.createElement("a",{href:"https://github.com/deformal/The-Issue-Tracker-app"},"Saurabh Jainwal")," ","Github Repository"))}class he extends d.a.Component{static async fetchData(e){const t=await _("query{user{\n      signedIn givenName\n    }}",null,null,e);return console.log(t),t}constructor(e){super(e);const t=y.userData?y.userData.user:null;delete y.userData,this.state={user:t},this.onUserChange=this.onUserChange.bind(this)}async componentDidMount(){try{const{user:e}=this.state;if(null===e){const e=await he.fetchData();this.setState({user:e.user})}}catch(e){console.log(e)}}onUserChange(e){this.setState({user:e})}render(){const{user:e}=this.state;return null==e?null:d.a.createElement("div",null,d.a.createElement(ce,{user:e,onUserChange:this.onUserChange}),d.a.createElement(b.Grid,{fluid:!0},d.a.createElement(I.Provider,{value:e},d.a.createElement(ee,null))),d.a.createElement(ue,null))}}var de=n(7),me=n.n(de);var pe=async function(e,t){const n=Q.find(t=>Object(m.matchPath)(e.path,t));let a;try{if(n&&n.component.fetchData){const t=Object(m.matchPath)(e.path,n),s=e.url.indexOf("?"),o=-1!==s?e.url.substr(s):null;a=await n.component.fetchData(t,o,e.headers.cookie)}}catch(e){console.log(e)}const s=await he.fetchData(e.headers.cookie);y.initialData=a,y.userData=s;const o={},i=d.a.createElement(m.StaticRouter,{location:e.url,context:o},d.a.createElement(he,null)),r=g.a.renderToString(i);o.url?t.redirect(301,o.url):t.send(function(e,t,n){return`<html lang="en">\n  <head>\n    <meta charset="UTF-8" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    \x3c!--react terminologies api--\x3e\n    <title>React App with a server and seperate jsx file</title>\n    <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css" />\n    <script src="https://apis.google.com/js/api:client.js"><\/script>\n    <style>\n      .panel-title a {\n        display: block;\n        width: 100%;\n        cursor: pointer;\n      }\n      table.table-hover tr {\n        cursor: pointer;\n      }\n    </style>\n  </head>\n\n  <body>\n    <div id="contents">${e}</div>\n    <script>\n    window.__INITIAL_DATA__ = ${me()(t)}\n    window.__USER_DATA__ = ${me()(n)}\n    \n    <\/script>\n    <script src="/env.js"><\/script>\n    <script src="/app.bundle.js"><\/script>\n    <script src="/vendor.bundle.js"><\/script>\n    \n  </body>\n</html>\n`}(r,a,s))};const ge=i()();u.a.install(),s.a.config();const Ee=process.env.UI_SERVER_PORT,fe=(n(15)[0],process.env.API_PROXY_TARGET);process.env.ENABLE_HMR;fe&&(ge.use("/graphql",l()({target:fe,changeOrigin:!0})),ge.use("/auth",l()({target:fe}))),process.env.UI_API_ENDPOINT||(process.env.UI_API_ENDPOINT="/graphql"),process.env.UI_SERVER_API_ENDPOINT||(process.env.UI_API_ENDPOINT=process.env.UI_API_ENDPOINT),process.env.UI_AUTH_ENDPOINT||(process.env.UI_AUTH_ENDPOINT="http://localhost:2000/auth"),ge.use(i.a.static("public"),(function(e,t,n){process.env.UI_API_ENDPOINT;n()})),ge.get("/env.js",(e,t)=>{const n={UI_API_ENDPOINT:process.env.UI_API_ENDPOINT,UI_AUTH_ENDPOINT:process.env.UI_AUTH_ENDPOINT,GOOGLE_CLIENT_ID:process.env.GOOGLE_CLIENT_ID};t.send(`window.ENV = ${JSON.stringify(n)}`),console.log(t.headersSent)}),ge.get("*",(e,t,n)=>{pe(e,t,n)}),ge.listen(Ee,(function(){console.log(`ui server started on port ${Ee}`)}))}]);
//# sourceMappingURL=server.js.map